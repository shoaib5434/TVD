<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="../images/logo.png">
	<link rel="stylesheet" type="text/css" href="../css/header.css">
	<link rel="stylesheet" type="text/css" href="../css/profile.css">
	<link rel="stylesheet" type="text/css" href="../css/sidebar.css">
	<link rel="stylesheet" type="text/css" href="../css/login.css">
	<link rel="stylesheet" type="text/css" href="../css/hashtag.css">
	<link rel="stylesheet" type="text/css" href="../css/search.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<title>TVD - shoaib.gondal</title>
</head>
<body>
	<!-- Header -->

	<div id="header">
		<div class="site-logo top-center">TVD</div>
		<div class="header-search top-center">
			<div class="search-box">
				<input type="" name="" placeholder="Search On TVD">
				<i class="fas fa-search"></i>
			</div>
		</div>
		<div class="header-buttons top-center">
			<button class="fas fa-search"></button>
			<a href="../upload/index.html" class="header-upload"> <div> <i class="fas fa-plus"></i> <p>Upload</p></div> </a>
			<a href="signup.html" class="header-signup"> Sign Up</a>
			<a href="" class="header-login"> Login</a>
			<div class="top-center">
				<img src="https://i.ibb.co/X5bx2mc/Shoaib.png" class="header-user-icon">
				<div class="shadow-down">
					<i class="fas fa-caret-down"></i>
				</div>
			</div>
		</div>
	</div>

	<div id="options">
		<div class="setting-logo">
			<i class="fa-solid fa-cog"></i>
			<p>Settings</p>
		</div>
		<div class="logout">
			<i class="fa-solid fa-arrow-right-from-bracket"></i>
			<p>Logout</p>
		</div>
	</div>

	<!-- SideBar -->

	<div class="sideBar">
		<a href="/TVD (FYP)/"><i class="fas fa-home"></i><p> Home</p></a>
		<a href=""><i class="fas fa-user-group"></i><p> Following</p></a>
		<a href="/TVD (FYP)/profile/"><i class="fas fa-user"></i><p> Profile</p></a>
		<b><i class="fas fa-search"></i><p> Search</p></b>

		<p class="category">Category</p>
		<p class="accounts">Top Accounts</p>
		<div class="sug-acc">
		</div>
		<p class="hash-text">Trending</p>
		<div class="trends">
			<div class="trend">
				#imrankhan
			</div>
			<div class="trend">
				#westandwithkhan
			</div>
			<div class="trend">
				#khanwasright
			</div>
		</div>
	</div>

	<!-- Conent -->

	<div id="content">
		<div id="search">
			<div class="search-input">
				<p class="fas fa-search"></p>
				<input type="text" name="" placeholder="Search">
			</div>
			<div class="search-result">
				<div class="search-profile">
					<p class="selected">Videos</p>
					<p>Users</p>
					<p>Hashtags</p>
				</div>
				<div class="search-result-css search-result-video active" data-index='0'>
					<!-- <div class="single-video">
						<p class="fas fa-play"></p>
						<img src="../images/thumbails/638627c407b2c1669736388.png">
					</div> -->
					<div class="no-result">
						<i>ü§ê</i>
						<p>No Result Found</p>
					</div>
				</div>
				<div class="search-result-css search-result-user" data-index='1'>
					<!-- <div class="single-user" data-address="usama_nawaz">
						<img src="../images/DP/11usama_nawaz.jpg">
						<p>usama_nawaz</p>
					</div> -->
					<div class="no-result">
						<i>ü§ê</i>
						<p>No Result Found</p>
					</div>
				</div>
				<div class="search-result-css search-result-hashtag" data-index='2'>
					<!-- <div class="single-hashtag" data-address="foryou">
						<i>#</i>
						<p>#foryou</p>
					</div> -->
					<div class="no-result">
						<i>ü§ê</i>
						<p>No Result Found</p>
					</div>
				</div>
				<div class="no-history">
					<i class="fa-regular fa-clock"></i>
					<p>No History</p>
				</div>
			</div>
		</div>
		<div class="user-info">
			<p class="top-center hash-tag-icon">#</p>
			<div class="user-details top-center">
				<p class="hash-tag-name">#attackonkhan</p>
			</div>

			<button class="top-center"><p class="fa-solid fa-play"> </p>Make A Video</button>
			<!-- <div class="hashtag-details">
				<p class="total-videos">12k videos in total</p>
				<p class="total-videos-lastday">1.5k last day</p>
			</div> -->
		</div>
		<!-- <div class="user-description">
			<div class="user-description-cred">
				<div>
					<p>122K</p>
					<b>Following</b>
				</div>
				<div>
					<p>122K</p>
					<b>Follower</b>
				</div>
				<div>
					<p>122K</p>
					<b>Videos</b>
				</div>
			</div>
		</div> -->
		<div class="video-profile">
			<a href="" class="selected"><i class="fa-regular fa-clock"></i><p>Most Recent</p></a>
			<a href=""><i class="fas fa-arrow-trend-up"></i><p>Popular</p></a>
		</div>
		<div class="videos">
		</div>
	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script type="text/javascript" src="/TVD (FYP)/js/essentials.js"></script>
	<script type="text/javascript" src="/TVD (FYP)/js/search.js"></script>
	<script type="text/javascript">
		"use strict";
		let hashtag = new URLSearchParams(window.location.search).get('hashtag');
		let userVideos = [];
		let hashtagID;

		let getHashtagVideos = async (hashtag,start,limit) => {

			$.ajax({
				url : '../PHP/action.php',
				method : 'post',
				data : {
					action : 'get-hashtag-videos',
					hashtag : hashtag,
					start : start,
					limit : limit
				},
				dataType : 'json',
				success : function (data) {
					$('.hash-tag-name').text(data.hashtag);
					userVideos.push(data.data);
					hashtagID = data.id;
					if (userVideos.length == 0) {
						$('.videos').append(`
							<p class="no-video"> No Video Avaliable </p>
						`)
					}
					else {
						for (let i in data.data) {
							$('.videos').append(`

								<div class="singleVideo" data-index='${i}' style="background-image : url('../images/thumbails/${data.data[i].thumbail}');">
									<div class="playbtn">
										<p class="fas fa-play"></p>
									</div>
								</div>
							`)
						}
						$('.singleVideo').off('click');
						$('.singleVideo').on('click', (e) => {
							if (e.target.tagName == "P") {
								window.location = '/TVD (FYP)/?hashtag='+ hashtagID + '&index=' + e.target.parentNode.parentNode.getAttribute('data-index');
							}
							else {
								window.location = '/TVD (FYP)/?hashtag='+ hashtagID + '&index=' + e.target.parentNode.getAttribute('data-index');
							}
						})
					}
				}
			});

		}

		$('#content .user-info > button').on('click', () => {
			location = '/TVD (FYP)/upload/';
		})

		// 
		checkForSession();
		if (hashtag == null) {
			hashtag = "default";
		}
		else {
			$('.hash-tag-name').text(hashtag);
			$('title').text('#' + hashtag + ' - TVD');
		}
		console.log(hashtag)
		getHashtagVideos(hashtag,0,10);

	</script>
</body>
</html>